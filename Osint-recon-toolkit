import requests
import socket
import json
from datetime import datetime

# --- IP Lookup ---
def ip_lookup(ip):
    try:
        response = requests.get(f"http://ip-api.com/json/{ip}").json()
        return response
    except Exception as e:
        return {"error": str(e)}

# --- Domain WHOIS Lookup ---
def domain_whois(domain):
    try:
        result = requests.get(f"https://api.api-ninjas.com/v1/whois?domain={domain}", 
                               headers={'X-Api-Key': 'YOUR_API_KEY'}).json()
        return result
    except Exception as e:
        return {"error": str(e)}

# --- Email Breach Check ---
def email_breach(email):
    try:
        url = f"https://haveibeenpwned.com/api/v3/breachedaccount/{email}"
        headers = {'hibp-api-key': 'YOUR_API_KEY', 'User-Agent': 'OSINT-Toolkit'}
        result = requests.get(url, headers=headers)
        if result.status_code == 404:
            return "No breaches found."
        elif result.status_code == 200:
            return result.json()
        else:
            return {"error": result.status_code}
    except Exception as e:
        return {"error": str(e)}

# --- Main Program ---
if __name__ == "__main__":
    print("=== OSINT Recon Toolkit ===")
    print("1. IP Lookup")
    print("2. Domain WHOIS")
    print("3. Email Breach Check")
    choice = input("Choose an option: ")

    if choice == "1":
        ip = input("Enter IP address: ")
        print(json.dumps(ip_lookup(ip), indent=4))
    elif choice == "2":
        domain = input("Enter domain: ")
        print(json.dumps(domain_whois(domain), indent=4))
    elif choice == "3":
        email = input("Enter email: ")
        print(email_breach(email))
    else:
        print("Invalid choice.")
